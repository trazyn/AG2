define("modules/dashboard/service",[],function(){return{getCurrentUser:function(){return $.ajax({url:"/api/user",type:"GET"})},changePassword:function(t){return t.password=md5(t.password),t.newPassword=md5(t.newPassword),delete t.confirmPassword,$.ajax({url:"/api/user/changePassword",type:"POST",data:t})},getVideo:function(){return $.ajax({url:"/api/video",type:"GET"})},updateVideo:function(t){return $.ajax({url:"/api/video",type:"POST",data:t})},updateAbout:function(t){return t.desc=escape(t.desc),$.ajax({url:"/api/user/about",type:"POST",data:t})},getAbout:function(){return $.ajax({url:"/api/user/about",type:"GET"})},addPhoto:function(t){return $.ajax({url:"/api/gallery",type:"PUT",data:t})},removePhoto:function(t){return $.ajax({url:"/api/gallery/"+t,type:"DELETE"})},getGallery:function(t,a,e){return $.ajax({url:"/api/gallery/"+t,type:"GET",data:{keyword:a,type:e}})},getPosts:function(t,a){return $.ajax({url:"/api/posts/"+t,type:"GET",data:{title:a}})},publishPost:function(t){return $.ajax({url:"/api/posts",type:"PUT",data:t})},updatePost:function(t){return $.ajax({url:"/api/posts",type:"POST",data:t})},getPostDetail:function(t){return $.ajax({url:"/api/posts/detail/"+t,type:"GET"})},removePost:function(t){return $.ajax({url:"/api/posts/"+t,type:"DELETE"})}}});
define("modules/dashboard/updateAbout",["modules/dashboard/service"],function(e){"use strict";return function(t,r){var a={class4error:"error",selector:"[validators]",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}};t.delegate("button[name='updateAbout']","click",function(){var t=$(this),r=t.ripple({random:!0,speed:800}),s=t.parents(".md-validation").validation(a);"resolved"===s.validate().state()&&(r.show(),e.updateAbout(s.series()).done(function(e){return e.err?$.toast.error(e.err.message):void $.toast.success("Update success！")}).fail(function(){$.toast.error("Failed to update about，Please retry：（")}).always(function(){r.hide()}))})}});
define("modules/post/service",[],function(){"use strict";return{getPostDetail:function(t){return $.ajax({url:"/api/posts/detail/"+t,type:"GET"})},getPosts:function(t,e){return $.ajax({url:"/api/posts/"+t,type:"GET",data:{title:e}})},getNext:function(t){return $.ajax({url:"/api/posts/next/"+t,type:"GET"})},getPrev:function(t){return $.ajax({url:"/api/posts/prev/"+t,type:"GET"})}}});
define("modules/post/index",["modules/post/service"],function(e){"use strict";return function(t){function a(a,n){var i=t.find("nav");t.addClass("md-loading-show"),n=n||e.getPostDetail,n(a).done(function(e){return e.hasnext?i.addClass("hasnext"):i.removeClass("hasnext"),i[e.hasprev?"addClass":"removeClass"]("hasprev"),(e=e.data)?(d=e.id,Path.where("/#/post/"+d),t.find(".create-dete").text(dateutil(e.create_date).format("%B %A, %Y")),t.find("h1").text(e.title),t.find(".blog-bg").attr("src",e.teaser),t.find(".post-content-wrapper").html("<h2>"+e.title+"</h2>"+markdown.toHTML(e.content)),void t.removeClass("md-loading-show")):Path.where("/#/home")})}function n(a){var n="",d=t.find(".search input").val(),i=t.find(".post-list ul");return e.getPosts(a,d).done(function(e){e=e.rows;for(var t=0,d=e.length;d>t;++t){var r=e[t];n+='<li data-id="'+r.id+'"><h4>'+r.title+'</h4><span class="create-date">'+dateutil(r.create_date).format("%B %d, %Y")+"</span></li>"}1===a?i.html(n):i.append(n)})}var d=Path.where().params.id,i=1;t.delegate(".show-more, .hide-more","click",function(e){e.stopPropagation(),e.preventDefault(),t.toggleClass("show-search")}).delegate(".load-more","click",function(){var e=$(this).addClass("loading").attr("disabled",!0);n(++i).done(function(){e.removeAttr("disabled").removeClass("loading")})}).delegate(".search input","keyup",function(e){13===e.keyCode&&n(i=1)}).delegate("li[data-id]","click",function(){a(this.getAttribute("data-id"))}).delegate(".next","click",function(){a(d,e.getNext)}).delegate(".prev","click",function(){a(d,e.getPrev)}),a(d),n(i);var r=Path.where();$.extend(r,{enter:function(){var e=Path.where(),t=e.params.id;return t!==d&&a(e.params.id),!1},exit:function(){r.enter=null}})}});
define("ui/modal",[],function(){$.fn.modal=function(o){var e=["<div class='md-modal'>","<div style='height: 100%;'>","<div class='md-modal-head'></div><div class='icon-md-clear md-modal-close'></div>","<div class='md-modal-body'></div>","</div>","</div>","<div class='md-modal-overlay'></div>"].join(""),d=$(e),a=function(){$(document).off("keyup",n).off("click",l),o.onClose(),d.removeClass("show"),setTimeout(function(){d.remove()},300)},n=function(o){27===o.keyCode&&a()},l=function(o){$(o.target).hasClass("md-modal-overlay")&&a()},s=$.Deferred(),t=function(){var e=d.find(".md-modal-head"),t=d.find(".md-modal-body"),i=d.last();if(o.showTitle?e.html(o.title):e.hide().next().hide(),o.render instanceof Function?o.render.call(t,s,a):(t.html(o.render),s.resolve()),d.first().addClass(["md-modal-animation-"+o.animation,o.class4modal||""].join(" ")),i.addClass(o.mask?"show":"blank"),o.closeByESC||o.closeByDocument){var m=$(document).add(d);!0===o.closeByDocument&&d.off("click",l).on("click",l),"boolean"==typeof o.closeByESC&&m.off("keyup",n).on("keyup",n)}if(d.delegate(".md-modal-close","click",a),setTimeout(function(){d.first().addClass("show")},100),o.draggable){var c=o.draggable;e.css("cursor","move"),d.drag(function(o,e){$(this).css({top:e.offsetY,left:e.offsetX,width:d.width(),height:d.height(),"-webkit-transform":"none","-moz-transform":"none","-ms-transform":"none",transform:"none"})},{handle:c===!0?".md-modal-head":c})}d.appendTo(document.body)};return o=$.extend({},$.fn.modal.defaults,o||{}),this===$?o.target?$(o.target).on("click",t):o.autoShow&&t():this.on("click",t),{open:t,close:a,$node:d}},$.fn.modal.defaults={title:"Modal",showTitle:!0,mask:!0,draggable:!1,class4modal:"",closeByESC:!0,closeByDocument:!1,animation:"slide",render:"",autoShow:!0,onClose:$.noop},$.modal=$.fn.modal});
define("ui/toast",["ui/modal"],function(){"use strict";function t(t,e,n,i){void 0===i&&"string"==typeof n&&(i=n,n=!1),o&&o.close(),o=$.modal({showTitle:!1,mask:!1,animation:"scale",css:{"min-width":""},class4modal:"md-toast "+[e,i||""].join(" "),render:function(e,i,c){var a="<p class='md-toast-message'>"+t+"</p><p class='md-toast-close text-uppercase'>undo</p>";this.html(a).parent().css("height","").delegate(".md-toast-close","click",function(){o.close()}),clearTimeout(s),s=setTimeout(function(){o.close()},n||3e3)}}),o.$node.last().remove()}var o,s;return $.toast={top:function(o,s,e){return{left:function(){t(o,"md-toast-topleft",s,e)},right:function(){t(o,"md-toast-topright",s,e)}}},bottom:function(o,s,e){return{left:function(){t(o,"md-toast-bottomleft",s,e)},right:function(){t(o,"md-toast-bottomright",s,e)}}},success:function(t){this.top(t||"操作成功：）","md-toast-success").left()},error:function(t){this.top(t||"操作失败，请重试：（","md-toast-error").left()}},$.toast});
define("ui/ripple",[],function(){"use strict";var e="$ui.ripple",t=function(e,t){var i=this,s=t.duration+"ms",o=e.find("span.md-ripple-ink");this.$node=e.css("position","relative"),this.settings=t,o.length||(o=$("<span class='md-ripple-ink'>").appendTo(e)),t.autoBind&&!t.speed&&e.on("click",function(e){!i.$node.is("[disabled]")&&i.show(e)}),o.css({"-webkit-animation-duration":s,"-moz-animation-duration":s,"-ms-animation-duration":s,"-o-animation-duration":s,"animation-duration":s})};t.prototype={disabled:function(){return this.$node.attr("disabled",!0),this},enabled:function(){return this.$node.attr("disabled",!1),this},show:function(e){var t=this,i=t.settings,s=this.$node.offset(),o=e?e.pageX:s.left+this.$node.outerWidth()/2,n=e?e.pageY:s.top+this.$node.outerHeight()/2,d=this.$node[0].getBoundingClientRect(),a=$(document),r=Math.max(this.$node.outerHeight(),this.$node.outerWidth()),l=this.$node.find("span.md-ripple-ink").css({width:r,height:r}),p={top:n-d.top-l[0].offsetHeight/2-a.scrollTop(),left:o-d.left-l[0].offsetWidth/2-a.scrollLeft()};return clearTimeout(t.timer),i.speed=i.speed||i.originalSpeed,i.speed&&t.disabled().$node.addClass(i.class4progress),function u(e,t,s,a){if(e.timer=setTimeout(function(){t.removeClass("show").css({top:a.top,left:a.left,background:i.color||"#"+Math.floor(4095*Math.random()+0).toString(15)}),setTimeout(function(){t.addClass("show"),s?u(e,t,s,a):setTimeout(function(){t.removeClass("show")},i.duration<<1)},100)},e.settings.speed),e.settings.random){var r=t[0].offsetHeight,l=t[0].offsetWidth;a={top:n-d.top-document.body.scrollTop-(Math.random()*(0-r)+r),left:o-d.left-document.body.scrollLeft-(Math.random()*(0-l)+l)}}}(t,l,t.settings.speed,p),this},hide:function(e,t){var i,s=this,o=this.$node,n=this.settings;return void 0===n.originalSpeed&&(n.originalSpeed=n.speed),n.speed=0,clearTimeout(s.timer),o.removeClass(n.class4progress),i=e===!0||void 0===e?n.class4done:n.class4fail,o.addClass(i),setTimeout(function(){s.enabled(),o.removeClass(i)},t||2e3),this}},$.fn.ripple=function(i){var s=this.data(e);return s||(s=new t(this.addClass("md-ripple"),$.extend({},$.fn.ripple.defaults,i||{})),this.data(e,s)),s},$.fn.ripple.defaults={speed:0,duration:800,random:!1,color:!1,autoBind:!0,class4progress:"md-ripple-progress",class4done:"md-ripple-done",class4fail:"md-ripple-fail"}});
define("util/validators",[],function(){return $.extend({},{required:function(a,e,n,d){if(n.is(":checkbox"))return n.is(":checked");if(n.is(":radio")){var t=n.attr("name");return!!d.$node.find(":radio[name='"+t+"']:checked").length}return/[^\s]+/.test(a)},equals:function(a,e){return a===e},equalsIgnoreCase:function(a,e){return this.equals((a||"").toLowerCase(),(e||"").toLowerCase())},equalsTo:function(a,e,n,d){return this.equals(a,d.$node.find(e).val())},equalsIgnoreCaseTo:function(a,e,n,d){return this.equalsIgnoreCase(a,d.$node.find(e).val())},contains:function(a,e){return a&&e&&a.indexOf(e)>-1},startWith:function(a,e){return a&&e&&0===a.indexOf(e)},endWith:function(a,e){return a&&e&&a.lastIndexOf(e)===a.length-e.length},min:function(a,e){return a&&e&&+a.replace(/,/g,"")<e.toString().replace(/,/g,"")},max:function(a,e){return!this.min(a,e)},minLength:function(a,e,n,d){if(n.is(":checkbox")){var t=n.attr("name");return d.$node.find(":checkbox[name='"+t+"']:checked").length>e}return!!(a&&!isNaN(+e)&&a.length>e)},maxLength:function(){return!this.minLength.apply(this,arguments)},past:function(a){var e=new Date;return new Date(a)>+e},future:function(){return!this.past.apply(this,arguments)},after:function(a,e){return+new Date(a)>new Date(e)},before:function(){return!this.after.apply(this,arguments)}},function(){var a={"int":/^(?:[-+]?(?:0|[1-9][0-9]*))$/,"float":/^(?:[-+]?(?:[0-9]+))?(?:\.[0-9]*)?(?:[eE][\+\-]?(?:[0-9]+))?$/,alpha:/^[A-Z]+$/i,numeric:/^[-+]?[0-9]+$/,hexadecimal:/^[0-9a-fA-F]+$/,alphaNumeric:/^[A-Za-z0-9]+$/,uppercase:/[A-Z]+/,lowercase:/[a-z]+/,email:/^[-a-z0-9~!$%^&*_=+}{\'?]+(\.[-a-z0-9~!$%^&*_=+}{\'?]+)*@([a-z0-9_][-a-z0-9_]*(\.[-a-z0-9_]+)*\.(aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|pro|travel|mobi|[a-z][a-z])|([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}))(:[0-9]{1,5})?$/i,phone:/^(\+?0?86\-?)?1[345789]\d{9}$/,url:/^(?:(?:https?|ftp):\/\/)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,zipCode:/^[1-9]d{5}$/,timeString:/^(2[0-3]|[01]?[0-9]):([0-5]?[0-9]):([0-5]?[0-9])$/,dateString:/^(1[0-2]|0?[1-9])\/(3[01]|[12][0-9]|0?[1-9])\/(?:[0-9]{2})?[0-9]{2}$/,hexColor:/^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,idCard:/^[1-9]\d{7}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}$|^[1-9]\d{5}[1-9]\d{3}((0\d)|(1[0-2]))(([0|1|2]\d)|3[0-1])\d{3}([0-9]|X)$/,ip:/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$|^(([a-zA-Z]|[a-zA-Z][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z]|[A-Za-z][A-Za-z0-9\-]*[A-Za-z0-9])$|^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/},e={},n=function(a,n){e[a]=function(a){return n.test(a)}};for(var d in a)a.hasOwnProperty(d)&&n(d,a[d]);return e}())});
define("ui/validation",["util/validators"],function(validators){function mouseenter(e){var t,a=$(this),s=e.data.container,o=e.data.message,i=e.data.tooltipOffset,n=a.offset(),r=s.offset();a.hasClass("md-validation-tooltiped")||(t=$("<div class='md-validation-message'><p>"+o+"</p></div>").css({position:"absolute",top:n.top-30-r.top+(i.top||0),left:n.left-r.left+(i.left||0)}).appendTo(s),a.addClass("md-validation-tooltiped").data("tooltip",t),a.off("mouseleave",mouseleave).on("mouseleave",{target:a,tooltip:t},mouseleave),setTimeout(function(){t.addClass("md-error-show")}))}function mouseleave(e){var t=e.data.tooltip;t.removeClass("md-error-show"),setTimeout(function(){t.remove()},300),e.data.target.removeClass("md-validation-tooltiped")}function clean(e,t){e.removeClass(t.class4error).off("mouseenter",mouseenter).off("mouseleave",mouseleave).removeClass("md-validation-tooltiped").removeData("tooltip")}function change(e){var t=e.data.args.instance,a=t.settings,s=e.data.args.target,o=e.data.args.parameter,i=e.data.args.validator;$.when(i.call(a.validators,s.val(),o,s,t)).done(function(){var e=s.data("tooltip");clean(s,a),e&&e.remove()})}var namespace="$ui.validation",Validation=function(e,t){var a=this;t.validators=$.extend({},validators,t.validators),this.$node=e,this.settings=t,e.delegate(":reset","click",function(){a.clean()}),t.autoValidate&&e.delegate(t.selector,"focusout",function(e){a.validate([$(this)])})};Validation.prototype={validate:function(eles){function getMessage(e){var t=e.attr("messages"),a=(t||"").match(/(\w+\s*:\s*'[^']+')+/g)||[];for(t={};a.length;){var s=a.pop().split(":");t[s[0].trim()]=s[1].replace(/^\s*'|'\s*/g,"")}return t}function handle(e,t,a){var s,o,i,n;if("string"==typeof t)n=a[t],t=settings.validators[t];else{var r=Object.keys(t)[0],i=t[r],t=settings.validators[r],n=a[r];!t&&i instanceof Function&&(t=i,i=void 0)}return n=n||settings.message,o=t.call(settings.validators,e.val(),i,e,self),o===!1?(s=$.Deferred(),s.reject()):s=o,e=settings.parseElement(e,settings),$.when(s).fail(function(){e.addClass(settings.class4error).off("mouseenter",mouseenter),settings.showMessage&&e.on("mouseenter",{message:n,container:self.$node,tooltipOffset:settings.tooltipOffset||{}},mouseenter)}).done(function(){e.removeClass(settings.class4error).off("mouseenter",mouseenter).off("mouseleave",mouseleave)}),deferreds.push(s),e.off("change",change).on("change",{args:{target:e,validator:t,parameter:i,instance:self}},change),o}for(var self=this,settings=this.settings,deferreds=[],eles=eles||this.$node.find(settings.selector),i=eles.length;--i>=0;){var ele=$(eles[i]),messages=getMessage(ele),validators=ele.attr("validators")||[];try{validators=eval(validators)}catch(ex){validators=[]}for(var m=0,length=validators.length;length>m&&(handle(ele,validators[m],messages)||!settings.breakOnError);++m);}return $.when.apply($,deferreds)},series:function(){var e={};return this.$node.find(this.settings.selector).each(function(){var t=$(this),a=t.attr("name");if(a){if(t.is("[type=radio]"))return void(t.is(":checked")&&(e[a]=t.val()));if(t.is("[type=checkbox]"))return e[a]=e[a]||[],void(t.is(":checked")&&e[a].push(t.val()));e[a]=t.val()}}),e},clean:function(){var e=this.settings;return this.$node.find(e.selector).each(function(){clean(e.parseElement($(this).val("")),e)}),this}},$.fn.validation=function(e){var t=this.data(namespace);return t||(t=new Validation(this,$.extend(!0,{},$.fn.validation.defaults,e)),this.data(namespace,t)),t},$.fn.validation.defaults={class4error:"md-error",selector:":input[validators]:visible:not(button)",message:"Invalid input",breakOnError:!0,showMessage:!0,autoValidate:!1,parseElement:function(e){var t=e.parent();return e.is("select, :checkbox, :radio")&&t.is(".md-select, .md-switch, .md-radio")?e.is(":radio")&&t.parent().is(".ui.radioes")?t.parent():t:e.is(":checkbox")&&(t=e.parents(".ui.checkboxes:first"),t.length)?t:e},validators:{}}});
define("util/storage",function(){var n,t="sessionStorage",e=function(){try{return t in window&&window[t]}catch(n){return!1}}(),o=function(n){return JSON.stringify(n||"")},r=function(n){if("string"!=typeof n)return n;try{return JSON.parse(n)}catch(t){return n||""}},i={use:function(n){},set:function(n,t,e){},get:function(n,t){},all:function(){},foreach:function(n){},remove:function(n){},clear:function(){}};return e&&(n=window[t],i.use=function(t){return t&&{sessionStorage:1,localStorage:1}.hasOwnProperty(t)&&(n=window[t]),this},i.get=function(t,e){return this.use(e===!0?"localStorage":"sessionStorage"),r(n[t])},i.set=function(t,e,r){return this.use(r===!0?"localStorage":"sessionStorage"),n[t]=o(e)},i.foreach=function(t){for(var e,o=n.length;--o>=0;)e=n.key(o),t(e,r(n[e]))},i.all=function(n){var t={};return this.use(n===!0?"localStorage":"sessionStorage"),this.foreach(function(n,e){t[n]=e}),t},i.remove=function(t,e){this.use(e===!0?"localStorage":"sessionStorage"),n.removeItem(t)},i.clear=function(t){this.use(t===!0?"localStorage":"sessionStorage"),n.clear()}),i});
define("modules/login/service",[],function(){return{login:function(n){return n.password=md5(n.password),$.ajax({url:"/api/user/login",type:"POST",data:n})}}});
define("modules/login/index",["modules/login/service","util/storage","ui/validation","ui/ripple","ui/toast"],function(e,o){"use strict";return function(i){(o.get("user")||{}).user&&(window.location.href="/"),i.delegate(".md-form-group input.md-field","focus focusout",function(e){var o=$(this).parent();"focusout"===e.type?o[this.value?"addClass":"removeClass"]("hasvalue").removeClass("focused"):o.addClass("focused")}).delegate("button","click",function(){var o=$(this),i=o.ripple({random:!0,speed:900}),t=o.parents(".sign-in").validation({class4error:"error",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}});"resolved"===t.validate().state()&&(i.show(),e.login(t.series()).done(function(e){return e.err?$.toast.error(e.err):void(window.location.hash="#/dashboard")}).always(function(){i.hide()}))}).delegate("input","keydown",function(e){13===e.which&&$(this).parents(".sign-in").find("button").trigger("click")})}});
define("modules/dashboard/changePassword",["modules/dashboard/service"],function(e){"use strict";return function(r,s){var a={class4error:"error",selector:"input, radio",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}};r.delegate("button[name='changePassword']","click",function(){var r=$(this),s=r.ripple({random:!0,speed:800}),o=r.parents(".md-validation").validation(a);"resolved"===o.validate().state()&&(s.show(),e.changePassword(o.series()).done(function(e){return e.err?$.toast.error(e.err.message):(o.clean(),void $.toast.success("修改密码成功！"))}).fail(function(){$.toast.error("修改密码失败，请重试：（")}).always(function(){s.hide()}))})}});
define("modules/photography/service",[],function(){return{getGallery:function(e,r){return $.ajax({url:"/api/gallery/"+e,type:"GET",data:{type:r,index:e}})}}});
define("modules/photography/index",["modules/photography/service","ui/toast"],function(e){"use strict";return function(t,i){function a(){l.addClass("loading"),e.getGallery(c,i).done(function(e){var t="";e.rows.forEach(function(e){t+="<li class='item loading' data-full='"+e.hidpi+"'><img src='"+e.teaser+"' onload='this.parentNode.classList.remove(\"loading\")'></li>"}),n(e.index,e.pageTotal),l.html(t).removeClass("loading")})}function n(e,t){d.find(".current").text(c=e),d.find(".total").text(r=t)}function o(e){return s.hasClass("open")||"string"!=typeof e?s.removeClass("open").fadeOut(300):void s.find("figure").css("background-image","url("+e+")").end().addClass("open").fadeIn(300)}var l=t.find("ul.gallery"),s=t.find(".lightbox"),d=t.find(".pagination"),c=1,r=1;i={portrait:1,"pre-wedding":2,wedding:3,others:4}[i],t.off("click").on("click",o).undelegate(".item","click").delegate(".item","click",function(e){e.stopPropagation(),e.preventDefault(),o(this.getAttribute("data-full"))}).undelegate(".icon-close","click").delegate(".icon-close","click",function(){c=1,t.removeClass("show"),l.addClass("loading"),n(c,r)}).undelegate(".next-page","click").delegate(".next-page","click",function(){r>c?a(++c):$.toast.error("This is the last page :)")}).undelegate(".prev-page","click").delegate(".prev-page","click",function(){c>1?a(--c):$.toast.error("This is the first page :)")}),t.addClass("show"),a()}});
define("modules/dashboard/gallery",["modules/dashboard/service"],function(service){"use strict";return function(ele,container){function loadGallery(){var e=ele.find(".gallery"),a=ele.find("#search").val(),t=dropdown.val()[0],o=["Portrait","Pre-Wedding","Wedding","Others"],i="";service.getGallery(index,a,t).done(function(a){for(var t=a.rows,n=0,l=t.length;l>n;++n){var d=t[n];i+='<li class="item"><img src="'+d.teaser+'"><div class="desc"><span class="photo-name">'+d.title+'</span><span class="photo-category "><i class="icon-turned-in"></i>'+o[d.type]+'</span><i class="icon-content-copy" title="Copy photo link to clipboard"></i><i class="icon-delete" title="Remove this photo" data-id="'+d.id+'"></i></div></li>'}e.html(i),pagination.val(a.index,a.pageTotal)}).fail(function(){$.toast.error("Failed to fetch gallery :)")})}var validationOptions={class4error:"error",selector:"input, radio",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}},index=1,pagination=ele.find(".md-pagination").pagination({total:1,index:index,onPageChange:function(e){index=e,loadGallery()}}),dropdown=ele.find(".md-dropdown").dropdown({data:[{text:"Portrait",value:"1"},{text:"Pre-Wedding",value:"2"},{text:"Wedding",value:"3"},{text:"Others",value:"4"}],nothing:"Choice photography type"});ele.delegate("button[name='search']","click",function(){index=1,loadGallery()}).delegate("button[name=addPhoto]","click",function(){$.modal({title:"Add Photo",class4modal:"modal-addPhoto",animation:"scale",render:function(ready,close){var self=this;this.html(container.find("modal[name='add-photo']").html()),ready.resolve(),setTimeout(function(){self.delegate("button[name=cancel]","click",close).delegate("button[name=submit]","click",function(){var e=$(this).ripple({random:!0,speed:800}),a=self.find(".form-horizontal").validation(validationOptions),t=a.series();if("resolved"===a.validate().state()){if(!t.img)return $.toast.error("Please upload photo");e.show(),service.addPhoto(a.series()).done(function(){close(),index=1,loadGallery(),$.toast.success("Add photo success :)")}).fail(function(){$.toast.error("Failed to add photo, Please retry :(")}).always(function(){e.hide()})}}).delegate(".md-form-group input.md-field","focus focusout",function(e){var a=$(this).parent();"focusout"===e.type?a[this.value?"addClass":"removeClass"]("hasvalue").removeClass("focused"):a.addClass("focused")}).find("input[type=file]").attr("id",+new Date).uploadify({auto:!0,buttonClass:"icon-create",buttonText:"",method:"PUT",multi:!1,queueSizeLimit:1,queueID:"fileQueue",swf:"../../../bower_components/uploadify/uploadify.swf",uploader:"/api/gallery",fileTypeExts:"*.jpg;*.bmp;*.gif;*.png",height:48,width:48,onUploadSuccess:function(file,data){var filename;data=eval("("+data+")"),filename=data.filename,self.find("input[name=img]").val(filename),self.find("img").attr("src",filename).addClass("hasvalue")},onUploadError:function(){$.toast.error("Upload pricing failed, Please retry :(")}})})}})}).delegate(".icon-delete[data-id]","click",function(){var e=$(this),a=e.attr("data-id"),t=e.parents("li").find(".photo-name").text();$.message.confirm({title:"Please confirm",message:"Do you want to remove the photo '"+t+"'?",onOk:function(){service.removePhoto(a).done(function(){index=1,loadGallery(),$.toast.success("Remove photo success :)")}).fail(function(){$.toast.error("Failed to remove photo, Please try again :)")})}})}),loadGallery()}});
define("ui/slide",[],function(){"use strict";var e="$ui.slide",t=function(e,t){var i=this,s=function(){clearInterval(s.timer),s.timer=setInterval(function(){i.next()},t.duration)},n=e.find("."+t.class4active+"[data-index]:first").attr("data-index");n?e.find(t.selector4item+", "+t.selector4dot).removeClass(t.class4active).filter("[data-index="+n+"]").addClass(t.class4active):i.change(e.find(t.selector4item).attr("data-index")),e.delegate(t.selector4dot,"click",function(){i.change(this.getAttribute("data-index"))}).delegate(t.selector4prev,"click",this.previous.bind(this)).delegate(t.selector4next,"click",this.next.bind(this)),this.$node=e,this.settings=t,this.index=n,e.on("mouseenter",function(){clearInterval(s.timer)}).on("mouseleave",s),s()};t.prototype={change:function(e){var t=this.$node,i=this.settings,s=t.find(i.selector4item),n=t.find(i.selector4dot),a=s.filter("[data-index="+this.index+"]");-1===e?(a=a.prev(i.selector4item),a.length||(a=s.last())):void 0===e?(a=a.next(i.selector4item),a.length||(a=s.first())):a=s.filter("[data-index="+e+"]"),e=a.attr("data-index"),this.index!==e&&(s.add(n).removeClass(i.class4active).filter("[data-index="+e+"]").addClass(i.class4active),this.index=e)},previous:function(){this.change(-1)},next:function(){this.change()}},$.fn.slide=function(i){var s=this.data(e);return s||(s=new t(this,$.extend({},$.fn.slide.defaults,i)),this.data(e,s)),s},$.fn.slide.defaults={selector4item:".slide-item",selector4dot:".slide-dots span",selector4prev:".slide-prev",selector4next:".slide-next",class4active:"slide-active",duration:6e3}});
define("modules/home/service",[],function(){return{getVideo:function(){return $.ajax({url:"/api/video",type:"GET"})},getNewest:function(){return $.ajax({url:"/api/gallery/newest",type:"GET"})},getNewestPost:function(){return $.ajax({url:"/api/posts/newest",type:"GET"})},getAbout:function(){return $.ajax({url:"/api/user/about",type:"GET"})}}});
define("modules/home/index",["modules/home/service","modules/photography/index","ui/slide","ui/toast","ui/validation"],function(e,t){"use strict";return function(a,i){var s=a.find(".menus li[data-index]"),o=function(){o.ticking=!0,setTimeout(function(){var e=n.attr("data-index"),t=s.filter("[data-index='"+e+"']");t.length&&(s.find(".md-link").removeClass("active"),t.find(".md-link").addClass("active")),o.ticking=!1},500)},n=a.find("section[data-index]:first");a.on("mousewheel",function(e){var t;o.ticking||(e.originalEvent.wheelDelta/120>0?(t=n.prev("section.background"),t.length&&(o(),n.removeClass("active"),n=t.removeClass("down-scroll").addClass("up-scroll"))):(t=n.next("section.background"),t.length&&(o(),n.removeClass("up-scroll active").addClass("down-scroll"),n=t)),n.addClass("active"))}).delegate(".menus li[data-index]","click",function(){var e=$(this),t=e.attr("data-index");e.parents("ul").find(".md-link").removeClass("active"),n!==t&&(n.removeClass("active"),n=a.find("section.background[data-index='"+t+"']").addClass("active"),a.find("section.background[data-index]").removeClass("up-scroll down-scroll"),n.prevAll("section.background[data-index]").removeClass("up-scroll").addClass("down-scroll"),e.find(".md-link").addClass("active"))}).delegate("form button[name=send]","click",function(e){var t=$(this).parents("form").validation();e.preventDefault(),e.stopPropagation(),"resolved"===t.validate().state()&&(i.start(),$.ajax({type:"POST",url:"service/sendFeedback",data:t.series()}).fail(function(){$.toast.top("Failed to send the feedback, please try again :(").left()}).done(function(){t.clean(),$.toast.top("Thank you for your feedback!","md-toast-lightGray").left()}).always(function(){i.done()}))}).delegate("section[data-index='photography'] a[data-type]","click",function(e){e.preventDefault(),e.stopPropagation(),t(a.find(".modal-photography"),this.getAttribute("data-type"))}).delegate("section[data-index='video-film'] a[data-type]","click",function(e){var t=$(this),a=t.attr("data-type"),i=t.parents(".row").find(".video[data-type]");e.preventDefault(),e.stopPropagation(),t.hasClass("active")||(t.addClass("active").parents("ul").find(".active").not(t).removeClass("active"),i.filter(".show").stop().fadeOut(400,function(){$(this).removeClass("show"),i.filter("[data-type='"+a+"']").stop().fadeIn(200,function(){$(this).addClass("show")})}))}).delegate(".showcase img","click",function(){var e=$(this);$.modal({showTitle:!1,class4modal:"modal-showcase",animation:"scale",closeByDocument:!0,render:function(t,a){this.html(e.clone())}})}).find(".slide:first").slide(),e.getVideo().done(function(e){var t=a.find("section[data-index='video-film']");["travel","wedding","movie"].forEach(function(a,i){var s=e[i];t.find(".video[data-type='"+a+"']").html(s.source)})}),e.getNewest().done(function(e){for(var t="",i=0,s=e.length;s>i;++i)(0===i||i%3===0)&&(t+='<div class="row">'),t+='<div class="col-md-4"><img src="'+e[i].teaser+'" class="md-loading md-loading-show" onload="this.classList.remove(\'md-loading-show\')"></div>',(i+1)%3===0&&(t+="</div>");a.find(".showcase").html(t)}),e.getNewestPost().done(function(e){for(var t="",i=function(e,t){return e.length>t?e.substr(0,t)+"...":e},s=0,o=e.length;o>s;++s){var n=e[s];t+='<div class="row post"><div class="col-md-4"><div class="post-cover image-zoom"><img src="'+n.teaser+'" alt=""></div></div><div class="col-md-8"><div class="post-title"><a class="md-link" href="/#/post/'+n.id+'">'+n.title+'</a></div><div class="post-content">'+i(n.content,200)+'</div><div class="post-date">'+dateutil(n.create_date).format("%d %A %Y")+"</div></div></div>"}a.find(".post-list").append(t)}),e.getAbout().done(function(e){a.find(".about-content").html(unescape(e.about))})}});
define("ui/dropdown",[],function(){"use strict";function e(e,t){var d=function(){for(var e="",d=t.data,n=0,o=t.data.length;o>n;++n){var s=d[n],i="<li "+(s.disabled?" disabled='disabled' ":"")+"data-value='"+s[t.valueKey]+"' data-index='"+n+"' title='"+s[t.textKey]+"'>"+t.formatter(s,t)+"</li>";e+=$("<p>").append($(i).attr("data-index",n)).html()}return e}();e.css("display","none").html("<ul>"+d+"</ul>").trigger("update.dropdown")}var t="$ui.dropdown",d=function(t,d){var n,o,s=this;t=$(t).attr("tabindex",1),this.$node=t,this.settings=d,n=t.find(d.selector4title).html(d.nothing),o=t.find(d.selector4list),t.on("focusout",function(e,d){setTimeout(function(){(d||!t.is(":focus")&&!o.is(":focus"))&&t.removeClass("md-dropdown-open")},400)}).on("update.dropdown",function(e){for(var t=[],s=o.find("li.md-dropdown-selected"),i=0;i<s.length;t.push(d.data[s.eq(i++).attr("data-index")][d.textKey]));t=t.join(",")||d.nothing,n.html(t).attr("title",t),o.css("display","")}).on(d.type,function(n){var o,s=d.data;if(!t.is("[disabled]")&&!t.hasClass(d.class4loading)){if(s instanceof Array)return void(t.hasClass("md-dropdown-open")||t.addClass("md-dropdown-open").focus());o=(s||$.noop)(),t.addClass(d.class4loading),$.when(o).done(function(n){if(n instanceof Array)s=n;else{if(!(this instanceof Array))throw new Error("Invalid data");s=this}d.data=s,e(t.find(d.selector4list),d),t.addClass("md-dropdown-open")}).fail(function(){t.addClass("md-dropdown-error")}).always(function(){t.removeClass(d.class4loading)})}}).delegate("li","select.dropdown",function(){var e=$(this);!1===d.multiple&&o.find("li.md-dropdown-selected").removeClass("md-dropdown-selected"),e.addClass("md-dropdown-selected")}).delegate("li","deselect.dropdown",function(){var e=$(this);!0===d.required&&e.hasClass("md-dropdown-selected")&&1===o.find("li.md-dropdown-selected").length||e.removeClass("md-dropdown-selected")}).delegate("li","click toggle",function(e){var n,o=$(this);o.is("[disabled]")||(n=o.hasClass("md-dropdown-selected"),n?o.trigger("deselect.dropdown"):o.trigger("select.dropdown"),t.trigger("update.dropdown"),d.onSelect.call(o,d.data[o.attr("data-index")],d),d.closeOnSelect&&t.trigger("focusout","Force close the dropdown~"),e.preventDefault(),e.stopPropagation())}),s.render(d.data)};d.prototype={render:function(t){var d=this.settings;return d.data=t,d.data instanceof Array&&e(this.$node.find(d.selector4list),d),this},val:function(e){var t=this.settings,d=[];if(!e)return this.$node.find("li.md-dropdown-selected").each(function(){d.push(t.valueKey?this.getAttribute("data-value"):t.data[this.getAttribute("data-index")])}),d;e=e instanceof Array?e:[e];for(var n=e.length;--n>=0;){var o=this.$node.find("ul li[data-value='"+e[n][t.valueKey]+"']");o.length&&(o.trigger("select.dropdown"),d.push(e[n][t.valueKey]))}return this.$node.trigger("update.dropdown"),this},add:function(t){var d=this.settings,t=d.data.concat(t);return this.settings.data=t,e(this.$node.find(d.selector4list),this.settings),this},selectAll:function(){var e=this.$node,t=this.settings,d=e.find("ul li");return t.multiple?d.addClass("md-dropdown-selected"):d.filter(".md-dropdown-selected").length||d.first().addClass("md-dropdown-selected"),e.trigger("update.dropdown"),this},deselectAll:function(){return this.$node.find("ul li").removeClass("md-dropdown-selected"),this.$node.trigger("update.dropdown"),this},disabled:function(){return this.$node.attr("disabled",!0),this},enabled:function(){return this.$node.removeAttr("disabled"),this},open:function(){this.$node.addClass("md-dropdown-open")},close:function(){this.$node.removeClass("md-dropdown-open")}},$.fn.dropdown=function(e){var n=this.data(t);return n||(n=new d(this,$.extend({},$.fn.dropdown.defaults,e)),this.data(t,n)),n},$.fn.dropdown.defaults={nothing:"Please select",selector4title:".md-dropdown-title",selector4list:".md-dropdown-list",class4loading:"md-dropdown-sync",type:"click",multiple:!1,required:!1,data:[],textKey:"text",valueKey:"value",closeOnSelect:!0,onSelect:$.noop,formatter:function(e,t){return"<span>"+(e[t.textKey]||e[t.valueKey])+"</span>"}}});
define("ui/message",["ui/modal"],function(){var e=function(e){var s={showTitle:!1,closeByDocument:!0};setTimeout(function(){$.modal($.extend(!0,{},s,e))},250)};$.message={message:function(s,t,n){var o={render:function(e,o){var i=["<div class='md-message ",s," md-tooltip md-tooltip-top' data-tooltip='Close outside close the message'>","<div class='md-message-flag'><i class='md-icon'></i></div>","<div class='md-message-content'><p>",t,"</p></div>","</div>"];this.parent().css("overflow","visible"),this.css({overflow:"visible",display:"table",padding:0}).html(i.join("")).parent().css("background","none"),n=+n,n>100&&setTimeout(o,n),e.resolve()}};e(o)},danger:function(e,s){this.message("md-message-danger",e,s)},info:function(e,s){this.message("md-message-info",e,s)},warning:function(e,s){this.message("md-message-warning",e,s)},success:function(e,s){this.message("md-message-success",e,s)},confirm:function(s){var t=function(){},n=$.extend({},{onOk:t,onClose:t},s||{});e({showTitle:!1,class4modal:"md-confirm",closeByDocument:!1,render:function(e,s){this.html("<div class='md-modal-content'><div class='md-confirm-content'><h2>"+(n.title||"Confirm")+"</h2><p>"+n.message+"</p></div></div><div class='md-modal-action text-right'><button class='md-btn md-btn-flat md-btn-default text-uppercase' name='close'>Cancel</button><button class='md-btn md-btn-flat md-btn-success text-uppercase' name='ok'>Ok</button></div>"),this.delegate("button[name=ok]","click",function(e){var t=n.onOk();(void 0===t||t)&&s()}).delegate("button[name=close]","click",function(e){n.onClose(),s()}),e.resolve()}})}}});
define("ui/pagination",function(){function n(n,e){var t=e.index,a=e.total,i="",o="",s=[],d=n.find(e.selector4nav);if(d.length||(d=n),7>=a)for(var r=1;a>=r;s+=" "+r++);else{if(t-3>2&&(i="1 2 ..."),a>t+3&&(o="..."),i)a-t>3&&s.push(t-2,t-1,t);else for(var r=3>t?6:t+3;--r>=1;s.unshift(r));if(o)t>5&&s.push(t+1,t+2);else for(var r=a-(3===a-t?6:5);++r<=a;s.push(r));s.unshift(i),s.push(o)}s=($.isArray(s)?s:[s]).join(" ").replace(/^\s+|\s$/g,"").split(" ");for(var r=0,l=s.length;l>r;++r)+s[r]?s[r]=s[r]==t?"<span class='md-pagination-current'>"+t+"</span>":"<a data-index='"+s[r]+"'>"+s[r]+"</a>":s[r]="<span class='md-pagination-normal'>...</span>";t>1&&s.unshift($("<a class='md-icon-prev' data-index='"+(t-1)+"'></a>")),a>t&&s.push($("<a class='md-icon-next' data-index='"+(t+1)+"'></a>")),d.html(s),n.find(e.selector4index).val(t)}var e=function(e,t){var a=t.index,i=t.total;a=+a||0,i=+i||a,a>i&&(a^=i,i^=a,a^=i),t.index=a,t.total=i,this.$node=e,this.settings=t,n(e,t),e.delegate("[data-index]:not(.md-pagination-current)","click",function(a){a.stopPropagation(),a.preventDefault(),t.index=+this.getAttribute("data-index"),t.onPageChange(t.index,t),n(e,t)}).delegate(t.selector4index,"keydown",function(n){13===n.keyCode&&$(this).next().trigger("click")}).delegate(t.selector4jump,"click",function(a){var i=$(this).prev(),o=+i.val();o>=1&&o<=t.total?(t.index=o,t.onPageChange(o,t),n(e,t)):i.select()})};e.prototype={val:function(e,t){var a=this.settings;return e?(a.index=e,t&&(a.total=t),n(this.$node,a),this):a.index}},$.fn.pagination=function(n){var t=new e(this,$.extend({},$.fn.pagination.defaults,n));return t},$.fn.pagination.defaults={index:1,total:1,onPageChange:$.noop,selector4nav:".md-pagination-nav",selector4index:"input:text",selector4jump:"[name=go]"}});
define("modules/dashboard/blog",["modules/dashboard/service"],function(e){"use strict";return function(t,a){function o(){var a=t.find(".posts"),o=t.find("#title").val(),s="";d.addClass("md-loading-show"),e.getPosts(i,o).done(function(e){for(var t=e.rows,o=0,n=t.length;n>o;++o){var i=t[o];s+='<li><h4 data-id="'+i.id+'">'+i.title+'</h4><span class="date">'+dateutil(i.create_date).format("%B %A, %Y")+'</span><span class="delete" data-id="'+i.id+'">DELETE</span></li>'}a.html(s),l.val(e.index,e.pageTotal),d.removeClass("md-loading-show")}).fail(function(){$.toast.error("Failed to fetch posts :)")})}function s(t){var s=function(t,a){return e.publishPost(t).done(function(e){a(),i=1,o(),$.toast.success("Publish post success :)")}).fail(function(){$.toast.error("Failed to publish post, Please retry :(")})},d=function(a,s){return a.id=t,e.updatePost(a).done(function(e){s(),i=1,o(),$.toast.success("Update post success :)")}).fail(function(){$.toast.error("Failed to update post, Please retry :(")})};$.modal({class4modal:"modal-blog",showTitle:!1,render:function(o,i){var l=this.addClass("md-loading");this.html(a.find("modal[name='blog']").html()).delegate("button[name=cancel]","click",i).delegate("button[name=submit]","click",function(){var e=$(this).ripple({random:!0,speed:800}),a=l.find(".form-horizontal").validation(n),o=a.series();"resolved"===a.validate().state()&&(e.show(),(t?d:s)(o,i).always(function(){e.hide()}))}),t?e.getPostDetail(t).done(function(e){e=e.data,["title","teaser","content"].some(function(t){l.find("[name='"+t+"']").val(e[t]).trigger("focusout")}),l.removeClass("md-loading-show")}):l.removeClass("md-loading-show"),o.resolve()}}).$node.delegate(".md-form-group .md-field","focus focusout",function(e){var t=$(this).parent();"focusout"===e.type?t[(this.value=this.value.replace(/^\s+|\s+$/g,""))?"addClass":"removeClass"]("hasvalue").removeClass("focused"):t.addClass("focused")})}var n={class4error:"error",selector:"input, textarea",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}},i=1,d=t.find(".md-loading"),l=t.find(".md-pagination").pagination({total:1,index:i,onPageChange:function(e){i=e,o()}});t.delegate("button[name='search']","click",function(){i=1,o()}).delegate("button[name=addPost]","click",function(){s()}).delegate("h4[data-id]","click",function(){s(this.getAttribute("data-id"))}).delegate(".delete[data-id]","click",function(){var t=this.getAttribute("data-id");$.message.confirm({title:"Please confirm",message:"Do you want to remove this post?",onOk:function(){e.removePost(t).done(function(){i=1,o(),$.toast.success("Remove post success :)")}).fail(function(){$.toast.error("Failed to remove post, Please try again :)")})}})}),o()}});
define("modules/dashboard/pricing",["modules/dashboard/service"],function(service){"use strict";return function(ele,container){ele.find("input[type=file]").attr("id",+new Date).uploadify({auto:!0,buttonClass:"icon-create",buttonText:"",multi:!1,queueSizeLimit:1,queueID:"fileQueue",swf:"../../../bower_components/uploadify/uploadify.swf",uploader:"api/pricing",fileTypeExts:"*.jpg;*.bmp;*.gif;*.png",height:48,width:48,onUploadSuccess:function(file,data){data=eval("("+data+")"),this.button.parents(".wrapper").find("img").attr("src",data.filename+"?"+ +new Date),$.toast.success("Change pricing success :)")},onUploadError:function(){$.toast.error("Upload pricing failed, Please retry :(")}})}});
define("modules/dashboard/video",["modules/dashboard/service"],function(e){"use strict";return function(a,t){var i={class4error:"error",selector:"input, radio",showMessage:!1,parseElement:function(e){return $(e).parents(".md-form-group")}};a.delegate("button[name='preview']","click",function(){var e=$(this),a=(e.ripple({random:!0}).show(),e.parents(".md-validation").validation(i));"rejected"!==a.validate().state()&&$.modal({showTitle:!1,class4modal:"modal-videoPreview",animation:"scale",closeByDocument:!0,render:function(e,t){this.html(a.$node.find("input[name='source']").val())}})}).delegate("button[name='submit']","click",function(){var a=$(this),t=a.ripple({random:!0,speed:800}).show(),n=a.parents(".md-validation").validation(i);"resolved"===n.validate().state()&&e.updateVideo(n.series()).done(function(e){$.toast.success("Update success :)")}).fail(function(){$.toast.error("Operation failed, Please retry :(")}).always(function(){t.hide()})}).delegate("nav > div[data-index]","click",function(){var e,a=$(this),t=this.getAttribute("data-index");a.hasClass("active")||(e=a.parents("section"),e.find(".active").removeClass("active"),e.find("[data-index='"+t+"']").addClass("active"))})}});
define("modules/dashboard/index",["modules/dashboard/service","modules/dashboard/gallery","modules/dashboard/video","modules/dashboard/changePassword","modules/dashboard/pricing","modules/dashboard/blog","modules/dashboard/updateAbout","util/storage","ui/pagination","ui/validation","ui/ripple","ui/toast","ui/modal","ui/message","ui/dropdown"],function(e,i,a,d,t,o,n,s){"use strict";return function(u){u.delegate(".md-form-group .md-field","focus focusout",function(e){var i=$(this).parent();"focusout"===e.type?i[(this.value=this.value.replace(/^\s+|\s+$/g,""))?"addClass":"removeClass"]("hasvalue").removeClass("focused"):i.addClass("focused")}).delegate(".slide-menu li[data-index]","click",function(){u.find("section.active[data-index], li.active[data-index]").removeClass("active"),u.find("section[data-index='"+this.getAttribute("data-index")+"']").addClass("active"),this.classList.add("active")}),e.getVideo().done(function(e){var i=u.find("section[data-index='videoFilm']");["travel","wedding","movie"].forEach(function(a,d){var t=e[d],o=i.find(".tab[data-index='"+a+"']");o.find("input[name='cover']").val(t.cover).trigger("focusout"),o.find("input[name='source']").val(t.source).trigger("focusout"),o.find("input[name='id']").val(t.id)}),i.removeClass("md-loading-show")}),e.getAbout().done(function(e){u.find("textarea[name=desc]").val(unescape(e.about)).trigger("focusout")}),new Clipboard(".icon-content-copy",{text:function(e){var i=$(e).parents("li").find("img").attr("src");return/http(s)?/i.test(i)?i:window.location.origin+"/"+i}}).on("success",function(e){$.toast.success("'"+e.text+"' has copied :)")}),e.getCurrentUser().done(function(e){s.set("user",e)}),i(u.find("section[data-index='photography']"),u),a(u.find("section[data-index='videoFilm']"),u),d(u.find("section[data-index='changePassword']"),u),t(u.find("section[data-index='pricing']"),u),o(u.find("section[data-index='blog']"),u),n(u.find("section[data-index='updateAbout']"),u)}});
require.config({baseUrl:"./src",paths:{ui:"../src/ui",util:"../src/util",modules:"../src/modules"}}),require(["util/storage","ui/toast","ui/dropdown","ui/modal","ui/pagination","ui/ripple","ui/slide","ui/validation","ui/message","util/validators","util/storage","modules/dashboard/service","modules/dashboard/blog","modules/dashboard/changePassword","modules/dashboard/gallery","modules/dashboard/pricing","modules/dashboard/video","modules/dashboard/index","modules/home/service","modules/home/index","modules/photography/service","modules/photography/index","modules/login/service","modules/login/index","modules/post/service","modules/post/index"],function(e){"use strict";var o=$("#container");Path.config({container:o,after:function(){o.find("script[type='amd']").each(function(){var e=this.src,s=$(document.body);s.addClass("md-loading-show"),e=e.substr(e.indexOf("src/modules")).substr(4).replace(/\.js$/i,""),require([e],function(e){e(o.children()),s.removeClass("md-loading-show")})})}}).when("#/home",{view:"src/modules/home/index.html"}).when("#/photography/:type?",{view:"src/modules/photography/index.html"}).when("#/login",{view:"src/modules/login/index.html"}).when("#/dashboard",{view:"src/modules/dashboard/index.html"}).when("#/post/:id",{view:"src/modules/post/index.html"}).otherwise("#/home").listen();var s;$.ajaxSetup({complete:function(o){401===o.status?($.toast.error("Please login!"),e.remove("user"),clearTimeout(s),s=setTimeout(function(){location.href="/#/login"},100)):413===o.status&&$.toast.error("Please check your network or upload file is too large :(")}})});